<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
	<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css" integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh" crossorigin="anonymous">
	
	<title>COVID-19 Dashboard</title>
</head>
<body>
	<div id="app" class="container">
		<h2 class="pb-2 pt-2">COVID-19 Tracking</h2>
		<table class="table table-sm table-hover table-bordered table-striped mt-5">
			<tr class="thead-light">
				<th>Locations</th>
				<th class="text-right">Positive</th>
				<th class="text-right">Negative</th>
				<th class="text-right">Pending</th>
				<th class="text-right">Death</th>
				<th class="text-right">Total</th>
			</tr>
			<tr>
				<td>ðŸ‡ºðŸ‡¸ USA</td>
				<td class="text-right">{{ usa.positive | formatNumber }}</td>
				<td class="text-right">{{ usa.negative | formatNumber }}</td>
				<td class="text-right">{{ usa.pending | formatNumber }}</td>
				<td class="text-right">{{ usa.death | formatNumber }}</td>
				<td class="text-right">{{ usa.total | formatNumber }}</td>
			</tr>
			<tr>
				<td>CA</td>
				<td class="text-right">{{ ca.positive | formatNumber}}</td>
				<td class="text-right">{{ ca.negative | formatNumber }}</td>
				<td class="text-right">{{ ca.pending | formatNumber }}</td>
				<td class="text-right">{{ ca.death | formatNumber }}</td>
				<td class="text-right">{{ ca.total | formatNumber }}</td>
			</tr>
			<tr>
				<td>ðŸ‡­ðŸ‡° Hong Kong</td>
				<td class="text-right">{{ hk.stats.confirmed | formatNumber}}</td>
				<td></td>
				<td></td>
				<td class="text-right">{{ hk.stats.deaths | formatNumber }}</td>
				<td class="text-right"></td>
			</tr>
		</table>
	</div>
</body>
<script src="https://cdn.jsdelivr.net/npm/vue/dist/vue.js"></script>
<script src="https://cdn.jsdelivr.net/npm/lodash@4.17.15/lodash.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>

<script type="text/javascript">
	var app = new Vue({
	  el: '#app',
	  beforeCreate() {
	  },
	  created() {
	  },
	  beforeMount() {
	  	this.getStates();
	  	this.getCaCount();
	  	this.getHkCount();
	  },
	  methods: {

	  	getStates: function() {
	  		axios
	  		  .get('https://covidtracking.com/api/us')
	  		  .then(response => (this.usa = response.data[0]))
	  		  .catch(error => console.log(error))
	  	},
	  	getCaCount: function() {
	  		axios
	  		  .get('https://covidtracking.com/api/states/daily')
	  		  .then(response => (this.ca = this.parseCount(response.data, 'CA')))
	  		  .catch(error => console.log(error))

	  	},
	  	getHkCount: function() {
	  		axios.get('https://corona.lmao.ninja/jhucsse')
	  			 .then(response => (this.hk = this.parseLamoCount(response.data, 'Hong Kong')))
	  			 .catch(error => console.log(error))
	  	},
	  	parseLamoCount: function(data, filter) {
	  		return _.find(data, function(o) {
	  			return o.province == 'Hong Kong';
	  		})
	  	},
	  	parseCount: function(data, filter) {
	  		return _.find(data, function(o) {
	  			return o.state == filter; 
	  		}); 
	  	}
	  },
	  data: {
	    states: '',
	    ca: {},
	    usa: {},
	    hk: {'stats': {}}
	  },
	  filters: {
	  	formatNumber: function(value) {
	  		return Number(value).toLocaleString();
	  	}
	  }
	})
</script>
</html>